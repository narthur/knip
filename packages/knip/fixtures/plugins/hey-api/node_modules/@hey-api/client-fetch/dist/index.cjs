'use strict';var I=async(n,r)=>{let e=typeof r=="function"?await r(n):r;if(e)return n.scheme==="bearer"?`Bearer ${e}`:n.scheme==="basic"?`Basic ${btoa(e)}`:e},z=(n,r,e)=>{typeof e=="string"||e instanceof Blob?n.append(r,e):n.append(r,JSON.stringify(e));},A=(n,r,e)=>{typeof e=="string"?n.append(r,e):n.append(r,JSON.stringify(e));},T={bodySerializer:n=>{let r=new FormData;return Object.entries(n).forEach(([e,a])=>{a!=null&&(Array.isArray(a)?a.forEach(i=>z(r,e,i)):z(r,e,a));}),r}},O={bodySerializer:n=>JSON.stringify(n,(r,e)=>typeof e=="bigint"?e.toString():e)},_={bodySerializer:n=>{let r=new URLSearchParams;return Object.entries(n).forEach(([e,a])=>{a!=null&&(Array.isArray(a)?a.forEach(i=>A(r,e,i)):A(r,e,a));}),r.toString()}},U={$body_:"body",$headers_:"headers",$path_:"path",$query_:"query"},D=Object.entries(U),P=(n,r)=>{r||(r=new Map);for(let e of n)"in"in e?e.key&&r.set(e.key,{in:e.in,map:e.map}):e.args&&P(e.args,r);return r},H=n=>{for(let[r,e]of Object.entries(n))e&&typeof e=="object"&&!Object.keys(e).length&&delete n[r];},W=(n,r)=>{let e={body:{},headers:{},path:{},query:{}},a=P(r),i;for(let[o,s]of n.entries())if(r[o]&&(i=r[o]),!!i)if("in"in i)if(i.key){let t=a.get(i.key),l=t.map||i.key;e[t.in][l]=s;}else e.body=s;else for(let[t,l]of Object.entries(s??{})){let f=a.get(t);if(f){let u=f.map||t;e[f.in][u]=l;}else {let u=D.find(([d])=>t.startsWith(d));if(u){let[d,c]=u;e[c][t.slice(d.length)]=l;}else for(let[d,c]of Object.entries(i.allowExtra??{}))if(c){e[d][t]=l;break}}}return H(e),e},B=n=>{switch(n){case "label":return ".";case "matrix":return ";";case "simple":return ",";default:return "&"}},N=n=>{switch(n){case "form":return ",";case "pipeDelimited":return "|";case "spaceDelimited":return "%20";default:return ","}},Q=n=>{switch(n){case "label":return ".";case "matrix":return ";";case "simple":return ",";default:return "&"}},S=({allowReserved:n,explode:r,name:e,style:a,value:i})=>{if(!r){let t=(n?i:i.map(l=>encodeURIComponent(l))).join(N(a));switch(a){case "label":return `.${t}`;case "matrix":return `;${e}=${t}`;case "simple":return t;default:return `${e}=${t}`}}let o=B(a),s=i.map(t=>a==="label"||a==="simple"?n?t:encodeURIComponent(t):m({allowReserved:n,name:e,value:t})).join(o);return a==="label"||a==="matrix"?o+s:s},m=({allowReserved:n,name:r,value:e})=>{if(e==null)return "";if(typeof e=="object")throw new Error("Deeply-nested arrays/objects aren\u2019t supported. Provide your own `querySerializer()` to handle these.");return `${r}=${n?e:encodeURIComponent(e)}`},q=({allowReserved:n,explode:r,name:e,style:a,value:i})=>{if(i instanceof Date)return `${e}=${i.toISOString()}`;if(a!=="deepObject"&&!r){let t=[];Object.entries(i).forEach(([f,u])=>{t=[...t,f,n?u:encodeURIComponent(u)];});let l=t.join(",");switch(a){case "form":return `${e}=${l}`;case "label":return `.${l}`;case "matrix":return `;${e}=${l}`;default:return l}}let o=Q(a),s=Object.entries(i).map(([t,l])=>m({allowReserved:n,name:a==="deepObject"?`${e}[${t}]`:t,value:l})).join(o);return a==="label"||a==="matrix"?o+s:s};var J=/\{[^{}]+\}/g,M=({path:n,url:r})=>{let e=r,a=r.match(J);if(a)for(let i of a){let o=false,s=i.substring(1,i.length-1),t="simple";s.endsWith("*")&&(o=true,s=s.substring(0,s.length-1)),s.startsWith(".")?(s=s.substring(1),t="label"):s.startsWith(";")&&(s=s.substring(1),t="matrix");let l=n[s];if(l==null)continue;if(Array.isArray(l)){e=e.replace(i,S({explode:o,name:s,style:t,value:l}));continue}if(typeof l=="object"){e=e.replace(i,q({explode:o,name:s,style:t,value:l}));continue}if(t==="matrix"){e=e.replace(i,`;${m({name:s,value:l})}`);continue}let f=encodeURIComponent(t==="label"?`.${l}`:l);e=e.replace(i,f);}return e},k=({allowReserved:n,array:r,object:e}={})=>i=>{let o=[];if(i&&typeof i=="object")for(let s in i){let t=i[s];if(t!=null)if(Array.isArray(t)){let l=S({allowReserved:n,explode:true,name:s,style:"form",value:t,...r});l&&o.push(l);}else if(typeof t=="object"){let l=q({allowReserved:n,explode:true,name:s,style:"deepObject",value:t,...e});l&&o.push(l);}else {let l=m({allowReserved:n,name:s,value:t});l&&o.push(l);}}return o.join("&")},E=n=>{if(!n)return "stream";let r=n.split(";")[0]?.trim();if(r){if(r.startsWith("application/json")||r.endsWith("+json"))return "json";if(r==="multipart/form-data")return "formData";if(["application/","audio/","image/","video/"].some(e=>r.startsWith(e)))return "blob";if(r.startsWith("text/"))return "text"}},$=async({security:n,...r})=>{for(let e of n){let a=await I(e,r.auth);if(!a)continue;let i=e.name??"Authorization";switch(e.in){case "query":r.query||(r.query={}),r.query[i]=a;break;case "cookie":r.headers.append("Cookie",`${i}=${a}`);break;case "header":default:r.headers.set(i,a);break}return}},C=n=>L({baseUrl:n.baseUrl,path:n.path,query:n.query,querySerializer:typeof n.querySerializer=="function"?n.querySerializer:k(n.querySerializer),url:n.url}),L=({baseUrl:n,path:r,query:e,querySerializer:a,url:i})=>{let o=i.startsWith("/")?i:`/${i}`,s=(n??"")+o;r&&(s=M({path:r,url:s}));let t=e?a(e):"";return t.startsWith("?")&&(t=t.substring(1)),t&&(s+=`?${t}`),s},x=(n,r)=>{let e={...n,...r};return e.baseUrl?.endsWith("/")&&(e.baseUrl=e.baseUrl.substring(0,e.baseUrl.length-1)),e.headers=j(n.headers,r.headers),e},j=(...n)=>{let r=new Headers;for(let e of n){if(!e||typeof e!="object")continue;let a=e instanceof Headers?e.entries():Object.entries(e);for(let[i,o]of a)if(o===null)r.delete(i);else if(Array.isArray(o))for(let s of o)r.append(i,s);else o!==void 0&&r.set(i,typeof o=="object"?JSON.stringify(o):o);}return r},g=class{_fns;constructor(){this._fns=[];}clear(){this._fns=[];}getInterceptorIndex(r){return typeof r=="number"?this._fns[r]?r:-1:this._fns.indexOf(r)}exists(r){let e=this.getInterceptorIndex(r);return !!this._fns[e]}eject(r){let e=this.getInterceptorIndex(r);this._fns[e]&&(this._fns[e]=null);}update(r,e){let a=this.getInterceptorIndex(r);return this._fns[a]?(this._fns[a]=e,r):false}use(r){return this._fns=[...this._fns,r],this._fns.length-1}},v=()=>({error:new g,request:new g,response:new g}),V=k({allowReserved:false,array:{explode:true,style:"form"},object:{explode:true,style:"deepObject"}}),F={"Content-Type":"application/json"},w=(n={})=>({...O,headers:F,parseAs:"auto",querySerializer:V,...n});var G=(n={})=>{let r=x(w(),n),e=()=>({...r}),a=s=>(r=x(r,s),e()),i=v(),o=async s=>{let t={...r,...s,fetch:s.fetch??r.fetch??globalThis.fetch,headers:j(r.headers,s.headers)};t.security&&await $({...t,security:t.security}),t.body&&t.bodySerializer&&(t.body=t.bodySerializer(t.body)),(t.body===void 0||t.body==="")&&t.headers.delete("Content-Type");let l=C(t),f={redirect:"follow",...t},u=new Request(l,f);for(let p of i.request._fns)p&&(u=await p(u,t));let d=t.fetch,c=await d(u);for(let p of i.response._fns)p&&(c=await p(c,u,t));let b={request:u,response:c};if(c.ok){if(c.status===204||c.headers.get("Content-Length")==="0")return t.responseStyle==="data"?{}:{data:{},...b};let p=(t.parseAs==="auto"?E(c.headers.get("Content-Type")):t.parseAs)??"json";if(p==="stream")return t.responseStyle==="data"?c.body:{data:c.body,...b};let h=await c[p]();return p==="json"&&(t.responseValidator&&await t.responseValidator(h),t.responseTransformer&&(h=await t.responseTransformer(h))),t.responseStyle==="data"?h:{data:h,...b}}let R=await c.text();try{R=JSON.parse(R);}catch{}let y=R;for(let p of i.error._fns)p&&(y=await p(R,c,u,t));if(y=y||{},t.throwOnError)throw y;return t.responseStyle==="data"?void 0:{error:y,...b}};return {buildUrl:C,connect:s=>o({...s,method:"CONNECT"}),delete:s=>o({...s,method:"DELETE"}),get:s=>o({...s,method:"GET"}),getConfig:e,head:s=>o({...s,method:"HEAD"}),interceptors:i,options:s=>o({...s,method:"OPTIONS"}),patch:s=>o({...s,method:"PATCH"}),post:s=>o({...s,method:"POST"}),put:s=>o({...s,method:"PUT"}),request:o,setConfig:a,trace:s=>o({...s,method:"TRACE"})}};exports.buildClientParams=W;exports.createClient=G;exports.createConfig=w;exports.formDataBodySerializer=T;exports.jsonBodySerializer=O;exports.urlSearchParamsBodySerializer=_;//# sourceMappingURL=index.cjs.map
//# sourceMappingURL=index.cjs.map